<!DOCTYPE html>
<html>
<head>
    <title>Neon Slots</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #000; color: #f0f; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: monospace; }
        .slot-machine { display: flex; gap: 10px; margin-bottom: 30px; padding: 20px; border: 4px solid #f0f; border-radius: 15px; box-shadow: 0 0 30px #f0f; background: #111; }
        .reel { width: 80px; height: 100px; border: 2px solid #fff; display: flex; align-items: center; justify-content: center; font-size: 50px; background: #000; overflow: hidden; }
        button { background: #f0f; color: white; border: none; padding: 15px 40px; font-size: 24px; border-radius: 10px; cursor: pointer; box-shadow: 0 0 20px #f0f; }
        h1 { text-shadow: 0 0 10px #f0f; color: #f0f; }
    </style>
</head>
<body>
    <h1>üé∞ NEON SLOTS üé∞</h1>
    <div class="slot-machine">
        <div class="reel" id="r1">üçí</div>
        <div class="reel" id="r2">üçã</div>
        <div class="reel" id="r3">üçá</div>
    </div>
    <button onclick="spin()" id="spinBtn">SPIN</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : 0;
        const items = ["üçí", "üçã", "üçá", "üíé", "7Ô∏è‚É£"];
        
        function spin() {
            let btn = document.getElementById('spinBtn');
            btn.disabled = true;
            let r1 = document.getElementById('r1');
            let r2 = document.getElementById('r2');
            let r3 = document.getElementById('r3');
            
            let interval = setInterval(() => {
                r1.innerText = items[Math.floor(Math.random() * items.length)];
                r2.innerText = items[Math.floor(Math.random() * items.length)];
                r3.innerText = items[Math.floor(Math.random() * items.length)];
            }, 100);

            setTimeout(() => {
                clearInterval(interval);
                let a = items[Math.floor(Math.random() * items.length)];
                let b = items[Math.floor(Math.random() * items.length)];
                let c = items[Math.floor(Math.random() * items.length)];
                
                // Demo Luck: 30% chance to force win for fun (Adjust as needed)
                if(Math.random() > 0.7) { a=b=c="7Ô∏è‚É£"; } 
                
                r1.innerText = a; r2.innerText = b; r3.innerText = c;
                
                if(a == b && b == c) {
                    let win = 50;
                    if(a == "7Ô∏è‚É£") win = 100;
                    fetch('/api/claim_win', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ user_id: userId, amount: win, game_name: 'Slots' })
                    });
                    tg.showAlert(`JACKPOT! üéâ +${win} XP`);
                } else {
                    tg.showAlert("Try Again! ‚ùå");
                }
                btn.disabled = false;
            }, 2000);
        }
    </script>
</body>
</html>